// Generated by CoffeeScript 1.3.3
(function() {
  var NT;

  NT = window.NT || {};

  window.NT = NT;

  NT.Game = (function() {
    var moveVelocity;

    function Game(canvas, contentLoader) {
      var background, g, ninja, platformTile;
      this.canvas = canvas;
      background = new Shape();
      g = background.graphics;
      g.beginLinearGradientFill(["#369", "#036"], [0, 1], 0, 0, 0, this.canvas.height).drawRect(0, 0, this.canvas.width, this.canvas.height).draw(this.canvas.getContext("2d"));
      background.cache(0, 0, this.canvas.width, this.canvas.height);
      this.stage = new Stage(this.canvas);
      this.stage.addChild(background);
      ninja = new Bitmap(contentLoader.imgNinja);
      ninja.x = 320;
      ninja.y = 240;
      this.stage.addChild(ninja);
      platformTile = new Bitmap(contentLoader.imgTile);
      platformTile.width = contentLoader.imgTile.width;
      platformTile.height = contentLoader.imgTile.height;
      this.platform = new NT.Platform(5, platformTile, 0, this.canvas.height - 60);
      this.stage.addChild(this.platform.getDisplayObject());
    }

    moveVelocity = -1;

    Game.prototype.tick = function() {
      if (!this.platform.isVisibleInCanvas(this.canvas)) {
        moveVelocity *= -2;
      }
      if (Math.abs(moveVelocity) > 10) {
        moveVelocity /= 10 | 0;
      }
      this.platform.move(moveVelocity);
      return this.stage.update();
    };

    return Game;

  })();

}).call(this);
